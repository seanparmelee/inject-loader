{"version":3,"sources":["webpack://InjectLoader/webpack/bootstrap","webpack://InjectLoader/external \"@babel/core\"","webpack://InjectLoader/./src/index.js","webpack://InjectLoader/./src/injectify.js","webpack://InjectLoader/./src/wrapper_template.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","source","inputSourceMap","this","cacheable","_injectify","_injectify2","code","map","callback","context","ast","_core","transformSync","babelrc","compact","filename","resourcePath","rootMode","dependencies","traverse","CallExpression","path","isIdentifier","node","callee","push","dependencyString","arguments","replaceWith","expressionStatement","conditionalExpression","callExpression","memberExpression","identifier","stringLiteral","processRequireCall","skip","length","emitWarning","wrapperModuleAst","file","program","_wrapper_template","SOURCE","body","SOURCE_PATH","DEPENDENCIES","arrayExpression","transformFromAstSync","sourceMaps","sourceMap","sourceFileName","undefined","configFile","template"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = require(\"@babel/core\");","// @flow\n\nimport injectify from './injectify.js';\n\nexport default function injectifyLoader(source: string, inputSourceMap: string) {\n  if (this.cacheable) {\n    this.cacheable();\n  }\n\n  const {code, map} = injectify(this, source, inputSourceMap);\n  this.callback(null, code, map);\n}\n","// @flow\n\nimport {transformSync, traverse, types as t, transformFromAstSync} from '@babel/core';\nimport wrapperTemplate from './wrapper_template.js';\n\nfunction processRequireCall(path) {\n  const dependencyString = path.node.arguments[0].value;\n  path.replaceWith(\n    t.expressionStatement(\n      t.conditionalExpression(\n        t.callExpression(\n          t.memberExpression(t.identifier('__injections'), t.identifier('hasOwnProperty'), false),\n          [t.stringLiteral(dependencyString)]\n        ),\n        t.memberExpression(t.identifier('__injections'), t.stringLiteral(dependencyString), true),\n        path.node\n      )\n    )\n  );\n\n  return dependencyString;\n}\n\nexport default function injectify(context: Object, source: string, inputSourceMap: string) {\n  const {ast} = transformSync(source, {\n    ast: true,\n    babelrc: false,\n    code: false,\n    compact: false,\n    filename: context.resourcePath,\n    rootMode: 'upward-optional'\n  });\n\n  const dependencies = [];\n  traverse(ast, {\n    CallExpression(path) {\n      if (t.isIdentifier(path.node.callee, {name: 'require'})) {\n        dependencies.push(processRequireCall(path));\n        path.skip();\n      }\n    },\n  });\n\n  if (dependencies.length === 0) {\n    context.emitWarning(\n      \"The module you are trying to inject into doesn't have any dependencies. \" +\n        'Are you sure you want to do this?'\n    );\n  }\n\n  const wrapperModuleAst = t.file(\n    t.program([\n      wrapperTemplate({\n        SOURCE: ast.program.body,\n        SOURCE_PATH: t.stringLiteral(context.resourcePath),\n        DEPENDENCIES: t.arrayExpression(dependencies.map(d => t.stringLiteral(d))),\n      }),\n    ]),\n    []\n  );\n\n  return transformFromAstSync(wrapperModuleAst, source, {\n    sourceMaps: context.sourceMap,\n    sourceFileName: context.resourcePath,\n    inputSourceMap: inputSourceMap || undefined,\n    babelrc: false,\n    configFile: false,\n    compact: false,\n    filename: context.resourcePath,\n  });\n}\n","// @flow\n\nimport {template} from '@babel/core';\n\nexport default template(`\n  module.exports = function __injector(__injections) {\n    __injections = __injections || {};\n\n    (function __validateInjection() {\n      var validDependencies = DEPENDENCIES;\n      var injectedDependencies = Object.keys(__injections);\n      var invalidInjectedDependencies = injectedDependencies.filter(function (dependency) {\n        return validDependencies.indexOf(dependency) === -1;\n      });\n\n      if (invalidInjectedDependencies.length > 0) {\n        var validDependenciesString = ' - ' + validDependencies.join('\\\\n - ');\n        var injectedDependenciesString = ' - ' + injectedDependencies.join('\\\\n - ');\n        var invalidDependenciesString = ' - ' + invalidInjectedDependencies.join('\\\\n - ');\n\n        throw new Error('Injection Error in ' + SOURCE_PATH + '\\\\n\\\\n' +\n          'The following injections are invalid:\\\\n' + invalidDependenciesString + '\\\\n\\\\n' +\n          'The following injections were passed in:\\\\n' + injectedDependenciesString + '\\\\n\\\\n' +\n          'Valid injection targets for this module are:\\\\n' + validDependenciesString + '\\\\n'\n        );\n      }\n    })();\n\n    __injector.sourcePath = SOURCE_PATH;\n    __injector.validDependencies = DEPENDENCIES;\n\n    var module = { exports: {} };\n    var exports = module.exports;\n\n    (function () {\n      SOURCE\n    })();\n\n    return module.exports;\n  }\n`);\n"],"sourceRoot":""}